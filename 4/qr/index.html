<html>
<head>
<script type="text/javascript" src=https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.5.1/svg.min.js></script>
<script type="text/javascript" src="./qrious.min.js"></script>
<meta charset="utf-8">
<meta name="viewport" content="initial-scale=1, width=device-width">
<title>
Cubes
</title>
<style>
body {
    background-color: #dddddd;
}
.qr1 {
    transform: rotate(45deg);
    position: absolute;
    left: 664px;
    top: 325px;
}
</style>
</head>
<body>
<div id=drawing></div>
<script type="text/javascript">
var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
var height = (window.innerHeight > 0) ? window.innerHeight : screen.height;

var a = 97;
var b = a / Math.sqrt(3);
var c = 0;
var d = Math.floor(width/a/2)+2;
var e = Math.floor(height/b/3)+2;

function cube(paper, tone, light, x ,y) {
    var offset = Math.floor(y % 2) * (a+2*c);
    var path = paper.path('M0 0 l ' + a + ' ' + -b + ' l ' + -a + ' ' + -b + ' l ' + -a + ' ' + b + ' z')
    path.fill("hsl("+(tone)+", 90%, "+(90-1.5*light)+"%)").move((2*a+4*c)*x + 2*c + offset, (3*b+4*c)*y + c)
    var path = paper.path('M0 0 l ' + -a + ' ' + -b + ' v ' + 2*b + ' l ' + a + ' ' + b + ' z')
    path.fill("hsl("+(tone)+", 90%, "+(90-2*light)+"%)").move((2*a+4*c)*x +c + offset, (3*b+4*c)*y + b + 2*c)
    var path = paper.path('M0 0 l ' + a + ' ' + -b + ' v ' + 2*b + ' l ' + -a + ' ' + b + ' z')
    path.fill("hsl("+(tone)+", 90%, "+(90-2.8*light)+"%)").move((2*a+4*c)*x + a + 3*c + offset, (3*b+4*c)*y + b + 2*c)
}

var draw = SVG('drawing').size(d*(2*a+4*c), e*(3*b+4*c));
for (i = 0; i < d+1; i++) {
    for (j = 0; j < e+1; j++) {
        var random = Math.floor(Math.random() * 99);
        if (random > -1) {
            cube(draw,((i * 7) + (j * 31)),9,i-1,j-1);
        }
    }
}
draw.viewbox(0, 0, width, height);
document.write('<img id="qr1" class="qr1">');
var tagstr = window.location.hash.substring(1);
(function() {
  const qr1 = new QRious({
    element: document.getElementById('qr1'),
    value: tagstr,
    background: "white",
    backgroundAlpha: 0.0,
    foreground: "black",
    foregroundAlpha: 0.5,
    level: 'L',
    padding: 0,
    size: 441
  })
})()
</script>
</body>
</html>
